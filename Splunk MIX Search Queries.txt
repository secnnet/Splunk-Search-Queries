Search for failed login attempts:
index=security sourcetype=WinEventLog:Security EventCode=4625
| stats count by host

Search for suspicious network activity:
index=network src_port=80 OR src_port=443
| stats count by src_ip, dest_ip

Search for malware activity:
index=security sourcetype="wineventlog:security" EventCode=4688 Image_Path=\AppData\Roaming\.exe
| stats count by host

Search for failed VPN logins:
index=vpn_log VPN_Status=failure
| stats count by VPN_Username

Search for suspicious DNS activity:
index=dns query_type=A NOT query_name=*.local
| stats count by query

Detecting Brute Force Attacks:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4625
| stats count by src_user
| where count>5

Detecting Malicious File Uploads:
index=web sourcetype="access_combined" cs_method=POST
| rex "(?i)/([^/\s]+.((jpe?g)|(png)|(gif)|(bmp)))$"
| stats count by src
| where count > 50

Detecting Data Exfiltration:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4663
| rex field=object_path "\\([^\\]+)\[^\\]+$"
| stats count by dest_user, extracted_field
| where count > 100

Detecting Suspicious Network Traffic:
index=SecnNet sourcetype="netflow"
| eval bytes_sent=bytes/1024/1024
| stats sum(bytes_sent) as total_sent by src_ip, dest_ip
| where total_sent > 100

Detecting Suspicious Login Activity:
index=SecnNet sourcetype="WinEventLog:Security" (EventCode=4624 OR EventCode=4672)
| stats count by src_user, dest
| where count>100

Detecting DDoS Attacks:
index=web sourcetype="access_combined"
| stats count by clientip, useragent
| where count > 10000
| eval count=count/3600
| where count > 100

Detecting Malware Infections:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4688
| search Image_Path IN (".exe",".dll","*.ocx")
| stats count by Account_Name, Image_Path
| where count > 100

Detecting Suspicious DNS Activity:
index=dns sourcetype="stream:dns"
| stats count by query, qclass, qtype, src_ip
| where count > 100
| eval ratio=count/reply_count
| where ratio>100

Detecting Malicious PowerShell Activity:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational"
| search "ScriptBlockText="
| rex "ScriptBlockText=\s*(?<script_block>.*)"
| eval script_block_length=length(script_block)
| stats count by User, script_block_length
| where script_block_length > 200

Detecting Phishing Attempts:
index=SecnNet sourcetype="mail" (subject="password" OR subject="account")
| stats count by src_user, subject
| where count > 50

Detecting Web Application Attacks:
index=SecnNet sourcetype="apache_access"
| rex "(?i)"(?<request>([^"]|\")*)""
| eval request=replace(request, "\"", """)
| eval request_length=length(request)
| stats count by clientip, method, uri, status, request_length
| where count > 100

Detecting Network Scans:
index=SecnNet sourcetype="bro_conn"
| stats count by id.orig_h
| where count > 1000

Detecting Ransomware Attacks:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4663
| search object_path=":\Users*\Documents*" OR object_path=":\Users*\Desktop*"
| stats count by object_path, dest_user
| where count > 500

Detecting Unauthorized Access to Sensitive Data:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4663
| search object_path=":\HR Data*" OR object_path=":\Financial Data*"
| stats count by object_path, dest_user
| where count > 50

Detecting Account Takeover:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4624
| stats count by account_name, src_ip
| where count > 50

Detecting Insider Threats:
index=SecnNet sourcetype="WinEventLog:Security" (EventCode=4663 OR EventCode=4656)
| stats count by object_path, dest_user
| where count > 1000

Detecting Advanced Persistent Threats:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4688
| search (Image_Path="*powershell.exe" OR Image_Path="*rundll32.exe") AND (ParentImage_Path!="*powershell.exe" AND ParentImage_Path!="*rundll32.exe")
| stats count by Image_Path, ParentImage_Path
| where count > 50
This search query will detect if suspicious processes like PowerShell or Rundll32 are executed, but not by another process like another instance of PowerShell or Rundll32. This can indicate potential advanced persistent threats or malware.

Detecting Remote Access Trojans:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode=1 Image="\AppData\Roaming\.exe"
| stats count by Image, ParentImage
| where count > 50
This search query will detect if suspicious executables are executed from a user's AppData\Roaming directory, indicating potential remote access trojans (RATs) or malware.

Detecting Credential Dumping:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode=10 TargetImage="*\lsass.exe"
| stats count by SourceImage, ProcessCommandLine
| where count > 10
This search query will detect if a process is dumping or extracting user credentials from the Local Security Authority Subsystem Service (LSASS) process, indicating potential credential dumping or harvesting.

Detecting Malicious PowerShell Scripts:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational"
| search "ScriptBlockText="
| regex "(?i)(Invoke-Expression)|((New-Object).(Net.WebClient).(DownloadFile))|((System.Net.WebClient).*(DownloadString))"
| stats count by User, ScriptBlockText
| where count > 10

Detecting File Deletion and Modification:
index=SecnNet sourcetype="WinEventLog:Security" (EventCode=4663 OR EventCode=4656)
| search (Accesses="DELETE" OR Accesses="WRITE_OWNER") AND (object_path=":\Users*\Documents*" OR object_path=":\Users*\Desktop*")
| stats count by dest_user, object_path
| where count > 50

Detecting DNS Tunneling:
index=SecnNet sourcetype="stream:dns"
| stats count by query, qclass, qtype, src_ip
| where count > 100
| eval ratio=count/reply_count
| where ratio>100 AND (query="" OR query=".") AND (qclass="" OR qclass="IN") AND (qtype="" OR qtype="A")

Detecting Brute-Force Attacks:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4625
| stats count by Account_Name, Failure_Reason
| where count > 10 AND Failure_Reason="%%2313"

Detecting Suspicious Network Traffic:
index=SecnNet sourcetype="bro_conn"
| stats count by id.orig_h, id.resp_h, id.resp_p, service
| where count > 1000

Detecting Malicious Domain Names:
index=SecnNet sourcetype="stream:dns"
| search query="*"
| eval domain=mvindex(split(lower(query), "."), -2) + "." + mvindex(split(lower(query), "."), -1)
| stats count by domain
| where count > 1000

Detecting HTTP-Based C2 Traffic:
index=SecnNet sourcetype="bro_http"
| search (method="POST" OR method="GET") AND (user_agent="PowerShell" OR user_agent="Python")
| stats count by dest_ip, method, uri, user_agent
| where count > 50

Detecting Brute-Force SSH Attacks:
index=SecnNet sourcetype="linux_secure" (message="Failed password" OR message="Invalid user")
| stats count by src_ip, user
| where count > 100

Detecting Malicious JavaScript:
index=SecnNet sourcetype="bro_http" method="GET"
| rex field=uri "..js"
| search uri="http"
| stats count by dest_ip, uri
| where count > 50

Detecting Malware Persistence:
index=SecnNet sourcetype="WinEventLog:Security" (EventCode=4688 OR EventCode=5140)
| search (Image_Path="*regsvr32.exe" OR Image_Path="*rundll32.exe") AND (ParentImage_Path!="*regsvr32.exe" AND ParentImage_Path!="*rundll32.exe")
| stats count by Image_Path, ParentImage_Path
| where count > 10

Detecting Web Application Attacks:
index=SecnNet sourcetype="access"
| search status="5??"
| stats count by clientip, uri
| where count > 1000

Detecting Data Exfiltration via Email:
index=SecnNet sourcetype="msx" OR sourcetype="maillog"
| search messageid=""
| rex field=messageid ".@(.*).com"
| stats count by domain, recipient_address
| where count > 50

Detecting SQL Injection Attacks:
index=SecnNet sourcetype="access"
| search method="GET" AND uri="select"
| stats count by clientip, uri
| where count > 1000

Detecting Credential Stuffing:
index=SecnNet sourcetype="access"
| rex field=request ".?(.)"
| rex field=_raw "username=(?<user>\w+)"
| stats count by user, clientip
| where count > 100
This search query will detect if a high number of failed login attempts are being made for a specific user account from a variety of IP addresses, indicating potential credential stuffing attacks.

Detecting Ransomware Activity:
index=SecnNet sourcetype="WinEventLog:Security" (EventCode=4656 OR EventCode=4663)
| search Accesses="WRITE_DATA" AND (Object_Name=":\Users*\Documents*.exe" OR Object_Name=":\Users*\Desktop*.exe")
| stats count by dest_user, Object_Name
| where count > 50

Detecting Privilege Escalation:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4624
| search Account_Name="*" AND Logon_Type=3
| stats count by Account_Name, Elevated_Token
| where count > 10 AND Elevated_Token="True"

Detecting Suspicious SMB Traffic:
index=SecnNet sourcetype="bro_conn" service=""
| search (id.orig_h="" AND id.resp_h="")
| stats count by id.orig_h, id.resp_h, service
| where count > 1000 AND service="" AND id.resp_p=445

Detecting Suspicious PowerShell Activity:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational" EventCode=4104
| search "New-Item" OR "Set-ItemProperty" OR "Remove-Item"
| stats count by ComputerName, ScriptName
| where count > 50

Detecting Malware Persistence via Startup Items:
index=SecnNet sourcetype="WinEventLog:Security" (EventCode=4688 OR EventCode=5140)
| search (Image_Path="ProgramData\Microsoft\Windows\Start Menu\Programs\Startup" OR Image_Path="AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup")
| stats count by Image_Path, ParentImage_Path
| where count > 10

Detecting Malicious SSH Traffic:
index=SecnNet sourcetype="linux_secure" (message="Failed password" OR message="Accepted publickey")
| stats count by src_ip, user
| where count > 100 AND user!="root"

Detecting Malware Infection via Registry Changes:
index=SecnNet sourcetype="WinEventLog:Security" (EventCode=4657 OR EventCode=4663)
| search Accesses="WRITE_OWNER" AND Object_Name="*:\Windows\System32*"
| stats count by Object_Name, dest_user
| where count > 50

Detecting Credential Theft via Mimikatz:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4688
| search Image_Path="mimikatz"
| stats count by ComputerName, Account_Name
| where count > 5

Detecting Malware Infection via Scheduled Tasks:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-TaskScheduler/Operational" EventCode=107
| search Task_Name="*"
| stats count by ComputerName, Task_Name
| where count > 10

Detecting Cryptocurrency Mining Malware:
index=SecnNet sourcetype="access"
| search method="GET" AND uri="cryptonight"
| stats count by clientip
| where count > 1000

Detecting Unauthorized Access Attempts:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4625
| search Failure_Reason!="An Error occurred during Logon" AND Logon_Type!="3"
| stats count by src_ip, Account_Name
| where count > 10

Detecting Malware Infection via Network Connections:
index=SecnNet sourcetype="bro_conn" id.resp_p=443
| stats count by id.orig_h, id.resp_h
| where count > 1000 AND id.orig_h!="" AND id.resp_h!=""

Detecting Data Exfiltration via DNS:
index=SecnNet sourcetype="dns"
| search query="" AND (answer!="" OR rcode!="NOERROR")
| stats count by clientip, query
| where count > 1000

Detecting Malware Infection via PowerShell Script Block Logging:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational" EventCode=4104
| search Script_Block_Text="IEXEncodedCommand*"
| stats count by ComputerName, Script_Name
| where count > 10

Detecting Phishing Attempts:
index=SecnNet sourcetype="mail" (subject="password" OR subject="login")
| stats count by sender, recipient
| where count > 50

Detecting Malware Infection via Process Hollowing:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-Sysmon/Operational" Image="*explorer.exe" EventCode=1
| search Image="*cmd.exe" AND ParentImage="*explorer.exe"
| stats count by ComputerName, ParentImage, Image
| where count > 10

Detecting Brute Force Attacks:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4625
| search Failure_Reason="%%2313"
| stats count by src_ip, Account_Name
| where count > 50

Detecting Malware Infection via Scheduled Tasks (Part 2):
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-TaskScheduler/Operational" EventCode=106
| search Task_Name="*"
| stats count by ComputerName, Task_Name
| where count > 10

Detecting DNS Tunneling:
index=SecnNet sourcetype="dns"
| search query="" AND answer=""
| stats count by clientip, query
| where count > 1000

Detecting Malware Infection via WMI:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-WMI-Activity/Operational"
| search Operation="__InstanceCreationEvent" AND TargetInstance!="*"
| stats count by ComputerName, Operation
| where count > 10

Detecting Malware Infection via Lateral Movement:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4624
| search Logon_Type="3"
| stats count by src_ip, Account_Name, dest_ip
| where count > 10

Detecting DDoS Attacks:
index=SecnNet sourcetype="bro_conn" id.resp_p=80 OR id.resp_p=443
| search method="POST" AND (uri="/xmlrpc.php" OR uri="/wp-login.php")
| stats count by id.orig_h
| where count > 1000

Detecting Malware Infection via Suspicious Registry Key Changes:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4657
| search Object_Name="\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" OR Object_Name="\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
| stats count by ComputerName, Object_Name
| where count > 10

Detecting Malware Infection via Scheduled Tasks (Part 3):
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-TaskScheduler/Operational" EventCode=140
| search Task_Name="*"
| stats count by ComputerName, Task_Name
| where count > 10

Detecting Malware Infection via PowerShell Script Block Logging (Part 2):
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational" EventCode=4103
| search Script_Block_Text="(Get-WmiObject -Class win32_process -Filter)*"
| stats count by ComputerName, Script_Name
| where count > 10

Detecting Privilege Escalation Attempts:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4672
| search Privilege_List="SeDebugPrivilege"
| stats count by src_ip, Account_Name
| where count > 10

Detecting Malware Infection via Unusual Network Traffic:
index=SecnNet sourcetype="bro_conn"
| search service!="dns" AND service!="http" AND service!="ssl" AND service!="smtp"
| stats count by id.orig_h, id.resp_h, service
| where count > 100

Detecting Malware Infection via Use of WMI Persistence:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-WMI-Activity/Operational"
| search Operation="__InstanceModificationEvent" AND TargetInstance!="*"
| stats count by ComputerName, Operation
| where count > 10

Detecting Suspicious User Account Activity:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4720 OR EventCode=4722 OR EventCode=4723 OR EventCode=4724 OR EventCode=4725 OR EventCode=4726 OR EventCode=4727 OR EventCode=4728 OR EventCode=4729 OR EventCode=4730 OR EventCode=4731 OR EventCode=4732 OR EventCode=4733 OR EventCode=4734 OR EventCode=4735 OR EventCode=4737 OR EventCode=4738 OR EventCode=4740 OR EventCode=4741 OR EventCode=4742 OR EventCode=4743 OR EventCode=4744 OR EventCode=4745 OR EventCode=4746 OR EventCode=4747 OR EventCode=4748 OR EventCode=4749 OR EventCode=4750 OR EventCode=4751 OR EventCode=4752 OR EventCode=4753 OR EventCode=4754 OR EventCode=4755 OR EventCode=4756 OR EventCode=4757 OR EventCode=4758 OR EventCode=4760 OR EventCode=4761 OR EventCode=4762 OR EventCode=4763 OR EventCode=4764 OR EventCode=4765 OR EventCode=4766 OR EventCode=4767 OR EventCode=4768 OR EventCode=4769 OR EventCode=4770 OR EventCode=4771 OR EventCode=4772 OR EventCode=4773 OR EventCode=4774 OR EventCode=4775 OR EventCode=4776 OR EventCode=4777 OR EventCode=4778 OR EventCode=4779 OR EventCode=4780 OR EventCode=4781 OR EventCode=4782 OR EventCode=4783 OR EventCode=4784 OR EventCode=4785 OR EventCode=4786 OR EventCode=4787 OR EventCode=4788 OR EventCode=4789 OR EventCode=4790 OR EventCode=4791 OR EventCode=4792 OR EventCode=4793 OR EventCode=4794 OR EventCode=4795 OR EventCode=4796 OR EventCode=4797 OR EventCode=4798 OR EventCode=4799 OR EventCode=4800 OR EventCode=4801 OR EventCode=4802 OR EventCode=4803 OR EventCode=5376 OR EventCode=5377 OR EventCode=5378 OR EventCode=5447 OR EventCode=5448
| stats count by src_ip, Account_Name, EventCode
| where count > 10

Detecting Malware Infection via Scheduled Tasks (Part 4):
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-TaskScheduler/Operational" EventCode=141
| search Task_Name="*"
| stats count by ComputerName, Task_Name

Detecting Malware Infection via DNS Tunneling:
index=SecnNet sourcetype="bro_dns" query=""
| rex field=q "\S+ (\S+)$"
| search qtype="" NOT qtype="PTR" NOT qtype="SOA" NOT qtype="NS" NOT qtype="MX" NOT qtype="A" NOT qtype="AAAA" NOT qtype="CNAME" NOT qtype="SRV" NOT qtype="HINFO"
| stats count by q, qtype
| where count > 1000

Detecting Brute Force Password Attacks:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4625
| stats count by src_ip, Account_Name
| where count > 10

Detecting Malware Infection via Suspicious Email Activity:
index=SecnNet sourcetype="*ms:o365:management:activity" Operation="SendMail"
| rex field=To "\w+@(\w+.\w+)"
| search NOT recipient_domain="company.com"
| stats count by recipient_domain
| where count > 100

Detecting Malware Infection via Suspicious File Modifications:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4656
| search Object_Name="\AppData\Roaming\.exe" OR Object_Name="\AppData\Local\Temp\.exe"
| stats count by ComputerName, Object_Name
| where count > 10

Detecting Malware Infection via Use of Windows Management Instrumentation (WMI):
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-WMI-Activity/Operational" EventCode=5861
| search QueryLanguage="WQL" AND Query="SELECT * FROM Win32_Process"
| stats count by ComputerName, Query
| where count > 10

Detecting Suspicious Privileged Account Activity:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4672
| search Privilege_List="SeTcbPrivilege" OR Privilege_List="SeImpersonatePrivilege" OR Privilege_List="SeAssignPrimaryTokenPrivilege"
| stats count by src_ip, Account_Name, Privilege_List
| where count > 10

Detecting Malware Infection via Registry Modification:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4657
| search Object_Name="*\Software\Microsoft\Windows\CurrentVersion\Run"
| stats count by ComputerName, Object_Name
| where count > 10

Detecting Potential Insider Threat Activity:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4624
| eval Success_Logon_Type=if(Logon_Type="2" OR Logon_Type="7", "Interactive", if(Logon_Type="3", "Network", if(Logon_Type="8", "NetworkCleartext", if(Logon_Type="10", "RemoteInteractive", "Unknown"))))
| search NOT Account_Name="" NOT Account_Name="ANONYMOUS LOGON" NOT Account_Name="$" Success_Logon_Type="Network"
| stats count by Account_Name, src_ip
| where count > 10

Detecting Malware Infection via Use of PowerShell:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-PowerShell/Operational" EventCode=4103
| search ScriptBlockText!="Search-ADAccount"
| stats count by ComputerName, ScriptBlockText
| where count > 10

Detecting Malware Infection via Suspicious Network Traffic:
index=SecnNet sourcetype="bro_conn"
| search id.orig_h="" id.resp_h="" id.resp_p="*"
| stats count by id.orig_h, id.resp_h, id.resp_p
| where count > 1000

Detecting Suspicious Process Execution via Windows Event Logs:
index=SecnNet sourcetype="WinEventLog:System" EventCode=4688
| search Process_Command_Line!="\System32\svchost.exe" AND Process_Command_Line!="\System32\services.exe"
| stats count by src_ip, Account_Name, Process_Name, Process_Command_Line
| where count > 10

Detecting Suspicious DNS Query Activity:
index=SecnNet sourcetype="dns" query!=""
| eval domain=lower(split(query,"\.",-1))
| lookup blacklisted_domains domain OUTPUT domain as domain_blacklisted
| search NOT domain_blacklisted=""
| stats count by query, clientip
| where count > 1000

Detecting Suspicious User Account Modifications:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4728 OR EventCode=4729 OR EventCode=4730 OR EventCode=4731 OR EventCode=4732 OR EventCode=4733
| stats count by Account_Name, EventCode
| where count > 10

Detecting Malware Infection via Suspicious Network Behavior:
index=SecnNet sourcetype="bro_conn"
| search NOT service="*"
| stats count by service, id.orig_h, id.resp_h, id.resp_p
| where count > 1000

Detecting Suspicious SSH Login Attempts:
index=SecnNet sourcetype="secure" action=login
| search method="publickey" OR method="password"
| stats count by user, src_ip
| where count > 10

Detecting Malware Infection via Suspicious Host Behavior:
index=SecnNet sourcetype="bro_conn"
| search id.resp_h="*"
| stats count by id.resp_h
| where count > 10000

Detecting Suspicious LDAP Queries:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4662
| search Object_Type="groupPolicyContainer" AND Object_DN="*CN=Policies,CN=System"
| stats count by ComputerName, Account_Name, Object_DN
| where count > 10

Detecting Suspicious File Deletion:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4663
| search Access_Mask="0x2" AND FileAttributes="Directory"
| stats count by src_ip, Account_Name, Object_Name
| where count > 10

Detecting Malware Infection via Use of Scheduled Tasks:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-TaskScheduler/Operational" EventCode=106
| search Task_To_Run!="\system32\.*"
| stats count by ComputerName, Task_To_Run
| where count > 10

Detecting Suspicious User Account Authentication:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4625
| search NOT Account_Name="" NOT Account_Name="ANONYMOUS LOGON" NOT Account_Name="$" NOT src_ip="127.0.0.1" Logon_Type="3"
| stats count by Account_Name, src_ip
| where count > 10

Detecting Malware Infection via Use of Windows Scripting Host (WSH):
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-WinRM/Operational" EventCode=300
| search Message!="Created WSH shell object"
| stats count by ComputerName, Message
| where count > 10

Detecting Suspicious Network Traffic via SSL:
index=SecnNet sourcetype="bro_ssl"
| search NOT server_name="*"
| stats count by server_name, id.orig_h, id.resp_h, id.resp_p
| where count > 1000

Detecting Suspicious DNS Traffic via DNS Tunneling:
index=SecnNet sourcetype="dns"
| eval domain=lower(split(query,"\.",-1))
| lookup blacklisted_domains domain OUTPUT domain as domain_blacklisted
| search NOT domain_blacklisted="*"
| stats count by query, clientip
| where count > 100 AND count < 200

Detecting Malware Infection via Suspicious HTTP Traffic:
index=SecnNet sourcetype="access_combined"
| search method="POST" status=200
| stats count by clientip, uri, method
| where count > 10

Detecting Suspicious Login Behavior via Microsoft Exchange Server Logs:
index=SecnNet sourcetype="WinEventLog:MSExchange Management" EventCode=1
| search EventMessage="WarningLogon failure on database*"
| stats count by src_ip, Account_Name, Database, Client_Info
| where count > 10

Detecting Malware Infection via Suspicious Registry Modifications:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4657
| search Object_Name!="\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall"
| stats count by src_ip, Account_Name, Object_Name
| where count > 10

Detecting Suspicious Network Traffic via SMB:
index=SecnNet sourcetype="smb"
| search NOT service="*"
| stats count by service, id.orig_h, id.resp_h
| where count > 1000

Detecting Suspicious Network Traffic via SSH:
index=SecnNet sourcetype="ssh"
| search NOT command="*"
| stats count by command, src_ip
| where count > 10

Detecting Malware Infection via Suspicious PowerShell Activity:
index=SecnNet sourcetype="XmlWinEventLog:Microsoft-Windows-PowerShell/Operational" TaskCategory="ScriptBlockInvocation"
| search NOT ScriptName="*"
| stats count by ComputerName, ScriptBlockText
| where count > 10

Detecting Suspicious DNS Traffic via DNS DGA:
index=SecnNet sourcetype="dns"
| eval domain=lower(split(query,"\.",-1))
| lookup blacklisted_domains domain OUTPUT domain as domain_blacklisted
| search NOT domain_blacklisted="*"
| stats count by query, clientip
| where count > 200

Detecting Malware Infection via Suspicious WMI Activity:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4656 OR EventCode=4658
| search Object_Name="root\cimv2"
| stats count by Account_Name, Object_Name
| where count > 10

Detecting Suspicious Network Traffic via ICMP:
index=SecnNet sourcetype="icmp"
| search NOT type="*"
| stats count by type, id.orig_h, id.resp_h
| where count > 1000

Detecting Suspicious Network Traffic via DNS:
index=SecnNet sourcetype="dns"
| search query_type!="*"
| stats count by query_type, query, clientip
| where count > 1000

Detecting Malware Infection via Use of Windows Management Instrumentation (WMI):
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-WMI-Activity/Operational" EventCode=5858
| search Query!="SELECT * FROM Win32_Processor"
| stats count by ComputerName, Query
| where count > 10

Detecting Suspicious Network Traffic via RDP:
index=SecnNet sourcetype="rdp"
| search NOT client_name="*"
| stats count by client_name, src_ip, dest_ip
| where count > 1000

Detecting Malware Infection via Suspicious HTTP User-Agent:
index=SecnNet sourcetype="access_combined"
| search User_Agent!="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299"
| stats count by clientip, User_Agent
| where count > 10

Detecting Suspicious Network Traffic via FTP:
index=SecnNet sourcetype="ftp"
| search NOT command="*"
| stats count by command, src_ip
| where count > 10

Detecting Suspicious Network Traffic via SSL/TLS:
index=SecnNet sourcetype="ssl"
| search NOT subject="*"
| stats count by subject, id.orig_h, id.resp_h
| where count > 1000

Detecting Malware Infection via Suspicious Office Documents:
index=SecnNet sourcetype="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode=11
| search Image="\winword.exe" OR Image="\excel.exe"
| rex field=TargetObject ".*\(?<filename>[^\]+)"
| stats count by Computer, filename
| where count > 10

Detecting Suspicious Network Traffic via NTP:
index=SecnNet sourcetype="ntp"
| search NOT leap_indicator="*"
| stats count by leap_indicator, id.orig_h, id.resp_h
| where count > 1000

Detecting Malware Infection via Suspicious DLL Loading:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4657
| search Object_Name="\Windows\System32\"
| stats count by Account_Name, Object_Name
| where count > 10

Detecting Suspicious Network Traffic via SNMP:
index=SecnNet sourcetype="snmp"
| search NOT sysDescr="*"
| stats count by sysDescr, src_ip
| where count > 1000

Detecting Suspicious Network Traffic via SMB:
index=SecnNet sourcetype="smb"
| search NOT command="*"
| stats count by command, src_ip
| where count > 10

Detecting Malware Infection via Suspicious Registry Changes:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode=13
| search Image="\reg.exe"
| rex field=TargetObject ".\(?<key>[^\]+)"
| stats count by Computer, key
| where count > 10

Detecting Suspicious Network Traffic via IRC:
index=SecnNet sourcetype="irc"
| search NOT nick="*"
| stats count by nick, src_ip
| where count > 1000

Detecting Malware Infection via Suspicious JavaScript Activity:
index=SecnNet sourcetype="access_combined"
| search cs_User_Agent="Firefox" AND cs_method="GET" AND cs_uri_stem="/js/"
| stats count by clientip, cs_User_Agent, cs_uri_stem
| where count > 10

Detecting Suspicious Network Traffic via Telnet:
index=SecnNet sourcetype="telnet"
| search NOT command="*"
| stats count by command, src_ip
| where count > 10

Detecting Suspicious Network Traffic via SSH:
index=SecnNet sourcetype="ssh"
| search NOT command="*"
| stats count by command, src_ip
| where count > 10

Detecting Malware Infection via Suspicious PowerShell Activity:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode=1
| search Image="\powershell.exe" AND CommandLine!="Get-EventLog"
| rex field=CommandLine ".-EncodedCommand (?<encoded_cmd>[^ ]+).*"
| stats count by Computer, encoded_cmd
| where count > 10

Detecting Suspicious Network Traffic via ICMP:
index=SecnNet sourcetype="icmp"
| search NOT icmp_type="*"
| stats count by icmp_type, src_ip, dest_ip
| where count > 1000

Detecting Malware Infection via Suspicious Scheduled Tasks:
index=SecnNet sourcetype="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode=1
| search Image="\schtasks.exe"
| rex field=CommandLine ". (?<task_name>[^\]+)$"
| stats count by Computer, task_name
| where count > 10

Detecting Suspicious Network Traffic via NetBIOS:
index=SecnNet sourcetype="netbios"
| search NOT name_service="*"
| stats count by name_service, src_ip, dest_ip
| where count > 1000

Search for any events that mention "RC4-HMAC":
index=SecnNet "RC4-HMAC"

Search for SSL/TLS connections that use RC4-HMAC cipher suite:
index=SecnNet sourcetype=ssl:default ssl_cipher_suite="RC4-HMAC"

Search for Windows events related to RC4-HMAC cipher usage:
index=SecnNet sourcetype="WinEventLog:Security" EventCode=4624 src_nt_domain=your_domain_here AuthenticationPackageName="Negotiate" LogonType=3 | rex field=TargetUserName ".\\(?<username>[^\s]+)" | search username!="ANONYMOUS LOGON" | search username!="*$"

Search for SSH connections that use RC4-HMAC cipher suite:
index=SecnNet sourcetype=ssh:log ssh_cipher="arcfour-hmac"
These search queries should help you identify any events 

Search for WPA2 wireless networks that use RC4-HMAC cipher:
index=SecnNet sourcetype=wifi:ssid | search security="WPA2" | search pairwise_cipher="TKIP" | search group_cipher="TKIP" | search key_mgmt="WPA-PSK" | search ieee80211_cipher="RC4"

Search for TLS connections that use RC4-HMAC cipher suite and have a weak key size:
index=SecnNet sourcetype=ssl:default ssl_cipher_suite="RC4-HMAC" | rex field=ssl_cipher_suite "RC4-HMAC-(?<key_size>\d+)" | search key_size<128

Search for HTTP requests or responses that use RC4-HMAC cipher suite:
index=SecnNet sourcetype="access_combined_wcookie" | search cs_cipher_suite="RC4-HMAC" OR sc_cipher_suite="RC4-HMAC"

Search for SSH connections that use RC4-HMAC cipher suite and have weak key exchange algorithms:
index=SecnNet sourcetype=ssh:log ssh_cipher="arcfour-hmac" | rex field=ssh_kex_algorithm "(?<kex_algorithm>\w+)\-" | search kex_algorithm="diffie-hellman-group1-sha1" OR kex_algorithm="diffie-hellman-group14-sha1"

Search for SSL/TLS connections that use RC4-HMAC cipher suite and have weak Diffie-Hellman key exchange parameters:
index=SecnNet sourcetype=ssl:default ssl_cipher_suite="RC4-HMAC" | rex field=ssl_cipher_suite "RC4-HMAC-(?<key_size>\d+)" | search key_size>=128 | search ssl_early_data=true | search ssl_server_cert_chain_verified=true | search ssl_key_exchange_algorithm="ECDHE|DHE"

Search for TLS connections that use RC4-HMAC cipher suite and have expired certificates:
index=SecnNet sourcetype=ssl:default ssl_cipher_suite="RC4-HMAC" | search ss

List all high severity alerts in the last 24 hours.
index=SecnNet severity=high earliest=-24h
| table source, sourcetype, _time, severity, description

Identify potential account lockouts in the last hour.
index=SecnNet action=failure earliest=-1h
| stats count by user
| where count > 5

Get a list of new user accounts created in the last week.
index=SecnNet action=create earliest=-7d user!="*default"
| table user, source, sourcetype, _time

Detect any login attempts from blacklisted IP addresses.
index=SecnNet source="firewall" action=login earliest=-1d
| lookup blacklist.csv IP OUTPUT IP as blacklist_IP
| search NOT IP=blacklist_IP
| table user, IP, _time

Search for attempts to delete critical files.
index=SecnNet source="file" action=delete
| search file="*/important/*"
| table user, file, _time

Identify users who have accessed files they should not have in the last 24 hours.
index=SecnNet action=* earliest=-24h
| search file="/sensitive/*" user!="admin"
| table user, file, _time

Get a list of all failed SSH login attempts in the last hour.
index=SecnNet source="ssh" action=failure earliest=-1h
| table user, IP, _time

Detect attempts to execute commands with sudo.
index=SecnNet source="sudo" action=*
| search command!="su"
| table user, command, _time

Find users who have been added to the sudoers file in the last 24 hours.
index=SecnNet source="sudoers" action=* earliest=-24h
| table user, group, _time

Identify users who have been logging in from unusual locations.
index=SecnNet action=* earliest=-24h
| iplocation src_ip
| stats count by user, Country
| where Country!="United States" AND count > 5
| table user, Country, _time

Get a list of all processes with high CPU utilization.
index=performance earliest=-24h
| stats avg(percent_cpu) as CPU by process_name
| sort -CPU
| head 10

Identify machines with low disk space.
index=performance earliest=-24h
| stats avg(percent_disk_space) as disk_space by host
| where disk_space < 10
| table host, disk_space, _time

Find users who have been accessing sensitive files outside of normal business hours.
index=SecnNet action=*
| search file="/sensitive/*"
| where (strftime("%H", _time) < "07" OR strftime("%H", _time) > "18")
| table user, file, _time

Get a list of all web requests with status code 404.
index=web source="access.log" status=404 earliest=-24h
| table clientip, method, uri_path, _time

Identify machines with outdated antivirus signatures.
index=antivirus action=update earliest=-24h
| stats count by host
| where count < 5
| table host, _time

Detect attempts to exploit vulnerabilities in web applications.
index=web source="access.log" action=exploit earliest

Search for any attempts to elevate privileges through group membership changes.
index=SecnNet action=group earliest=-24h
| search member_type="user" AND member_type="group" AND action="add"
| table user, group, _time

Identify machines with failed login attempts from multiple users.
index=SecnNet action=failure earliest=-24h
| stats count by host, user
| where count > 5
| table host, user, count, _time

Find users who have been attempting to access web pages with sensitive information.
index=web source="access.log" earliest=-24h
| search uri_path="/sensitive/*"
| table clientip, uri_path, _time

Get a list of all DNS requests for known malicious domains.
index=dns source="dns.log" earliest=-24h
| lookup malicious_domains.csv domain OUTPUT domain as malicious_domain
| search domain=malicious_domain
| table clientip, domain, _time

Detect potential malware infections by looking for unusual command line arguments.
index=SecnNet action=* earliest=-24h
| search process="*malware*" AND command_line="*abnormal argument*"
| table user, process, command_line, _time

Identify machines with suspicious network traffic patterns.
index=network source="network.log" earliest=-24h
| stats count by host, dest_ip
| where count > 100
| table host, dest_ip, count, _time

Get a list of all failed login attempts for a specific user.
index=SecnNet action=failure user="specific_user" earliest=-24h
| table source, sourcetype, _time, description

Search for attempts to exfiltrate sensitive data through email.
index=SecnNet action=* earliest=-24h
| search email_to="*sensitive_email_address*" AND attachment="*sensitive_data*"
| table user, email_from, email_to, attachment, _time

Identify machines with unusually high network bandwidth usage.
index=network source="network.log" earliest=-24h
| stats avg(bytes) as avg_bytes by host
| where avg_bytes > 100000000
| table host, avg_bytes, _time

Get a list of all successful file transfers from a specific machine.
index=SecnNet action=transfer source="specific_machine" earliest=-24h
| table source, dest, _time

Detect attempts to exploit vulnerabilities in the OS.
index=SecnNet source="system" action=*
| search description="*vulnerability*"
| table user, description, _time

Identify machines with outdated software versions.
index=SecnNet source="system" action=update earliest=-24h
| stats count by host
| where count < 5
| table host, _time

Search for attempts to bypass SecnNet measures.
index=SecnNet action=* earliest=-24h
| search description="*bypass*"
| table user, description, _time

Get a list of all successful logins with multi-factor authentication.
index=SecnNet action=login multifactor_auth="true" earliest=-24h
| table user, 

Identify machines with unapproved software installations.
index=SecnNet source="system" action=install earliest=-24h
| search software!="*approved_software*"
| table host, software, _time

Search for attempts to access files with unauthorized encryption.
index=SecnNet source="file" action=*
| search file="*/sensitive/*" AND encryption="*unauthorized*"
| table user, file, encryption, _time

Detect attempts to create unauthorized network connections.
index=network source="network.log" action=*
| search dest_port!="*allowed_port*" AND action="connect"
| table host, dest_ip, dest_port, _time

Get a list of all successful login attempts with unusual locations.
index=SecnNet action=login earliest=-24h
| iplocation src_ip
| stats count by user, Country
| where Country!="United States" AND count > 5
| table user, Country, _time

Identify machines with unusually high CPU usage.
index=performance earliest=-24h
| stats avg(percent_cpu) as CPU by host
| where CPU > 80
| table host, CPU, _time

Search for attempts to change critical system files.
index=SecnNet source="system" action=modify
| search file="*/critical/*"
| table user, file, _time

Get a list of all web requests with unusual user agents.
index=web source="access.log" earliest=-24h
| search user_agent="*unusual_user_agent*"
| table clientip, user_agent, uri_path, _time

Detect attempts to exploit vulnerabilities in email clients.
index=SecnNet source="email" action=*
| search description="*vulnerability*"
| table user, description, _time

Identify machines with large numbers of failed login attempts.
index=SecnNet action=failure earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to use unauthorized remote access tools.
index=SecnNet source="remote_access" action=*
| search tool!="*approved_tool*"
| table user, tool, _time

Identify machines with unapproved software installations.
index=SecnNet source="system" action=install earliest=-24h
| search software!="*approved_software*"
| table host, software, _time

Search for attempts to access files with unauthorized encryption.
index=SecnNet source="file" action=*
| search file="*/sensitive/*" AND encryption="*unauthorized*"
| table user, file, encryption, _time

Detect attempts to create unauthorized network connections.
index=network source="network.log" action=*
| search dest_port!="*allowed_port*" AND action="connect"
| table host, dest_ip, dest_port, _time

Get a list of all successful login attempts with unusual locations.
index=SecnNet action=login earliest=-24h
| iplocation src_ip
| stats count by user, Country
| where Country!="United States" AND count > 5
| table user, Country, _time

Identify machines with unusually high CPU usage.
index=performance earliest=-24h
| stats avg(percent_cpu) as CPU by host
| where CPU > 80
| table host, CPU, _time

Search for attempts to change critical system files.
index=SecnNet source="system" action=modify
| search file="*/critical/*"
| table user, file, _time

Get a list of all web requests with unusual user agents.
index=web source="access.log" earliest=-24h
| search user_agent="*unusual_user_agent*"
| table clientip, user_agent, uri_path, _time

Detect attempts to exploit vulnerabilities in email clients.
index=SecnNet source="email" action=*
| search description="*vulnerability*"
| table user, description, _time

Identify machines with large numbers of failed login attempts.
index=SecnNet action=failure earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to use unauthorized remote access tools.
index=SecnNet source="remote_access" action=*
| search tool!="*approved_tool*"
| table user, tool, _time

Identify machines with suspicious process activity.
index=SecnNet action=* earliest=-24h
| search process="*suspicious_process*"
| table user, process, _time

Search for attempts to delete system logs.
index=SecnNet source="system" action=delete
| search file="*/log/*"
| table user, file, _time

Get a list of all successful logins with unusual durations.
index=SecnNet action=login earliest=-24h
| eval duration = _time - _indextime
| search duration > 3600
| table user, IP, duration, _time

Detect attempts to use unauthorized USB devices.
index=SecnNet source="usb" action=*
| search device!="*approved_device*"
| table user, device, _time

Identify machines with unusually high memory usage.
index=performance earliest=-24h
| stats avg(percent_memory) as memory by host
| where memory > 80
| table host, memory, _time

Search for attempts to modify or delete critical registry keys.
index=SecnNet source="registry" action=*
| search key="*/critical/*"
| table user, key, _time

Get a list of all failed login attempts with unusual usernames.
index=SecnNet action=failure earliest=-24h
| search user="*unusual_username*"
| table user, IP, _time

Detect attempts to use unauthorized network protocols.
index=network source="network.log" action=*
| search protocol!="*approved_protocol*"
| table host, protocol, _time

Identify machines with large amounts of network traffic from unusual sources.
index=network source="network.log" earliest=-24h
| stats sum(bytes) as bytes by host, src_ip
| where bytes > 100000000
| table host, src_ip, bytes, _time

Search for attempts to bypass email SecnNet measures.
index=SecnNet source="email" action=*
| search description="*bypass*"
| table user, description, _time

Identify machines with high numbers of failed email delivery attempts.
index=SecnNet source="email" action=delivery_failure earliest=-24h
| stats count by host, recipient
| where count > 10
| table host, recipient, count, _time

Search for attempts to escalate privileges through service account abuse.
index=SecnNet action=* earliest=-24h
| search user="*service_account*" AND description="*escalation*"
| table user, description, _time

Detect attempts to use unauthorized VPNs.
index=SecnNet source="vpn" action=*
| search vpn!="*approved_vpn*"
| table user, vpn, _time

Identify machines with unusually high numbers of outbound email messages.
index=SecnNet source="email" action=send earliest=-24h
| stats count by host, sender
| where count > 100
| table host, sender, count, _time

Search for attempts to access sensitive files during non-business hours.
index=SecnNet source="file" action=* earliest=-24h
| search file="*/sensitive/*" AND NOT strftime(_time, "%H") >= 9 AND NOT strftime(_time, "%H") <= 17
| table user, file, _time

Get a list of all email messages with attachments over a certain size.
index=SecnNet source="email" action=send earliest=-24h
| search attachment_size > 1000000
| table user, attachment_name, attachment_size, _time

Detect attempts to use unauthorized cloud storage services.
index=SecnNet source="cloud" action=*
| search service!="*approved_service*"
| table user, service, _time

Identify machines with unusually high numbers of DNS requests.
index=dns source="dns.log" earliest=-24h
| stats count by host
| where count > 1000
| table host, count, _time

Search for attempts to download files from unauthorized websites.
index=SecnNet source="web" action=*
| search url!="*approved_url*" AND action="download"
| table user, url, _time

Get a list of all successful SSH logins from unusual IP addresses.
index=SecnNet action=login earliest=-24h
| search protocol="ssh" AND NOT src_ip="*allowed_IP*"
| table user, src_ip, _time

Identify machines with unusually high numbers of SSH failed login attempts.
index=SecnNet action=failure earliest=-24h
| search protocol="ssh"
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to create unauthorized network shares.
index=SecnNet source="network" action=*
| search share!="*approved_share*"
| table user, share, _time

Get a list of all successful FTP logins with unusual upload activity.
index=SecnNet action=login earliest=-24h
| search protocol="ftp" AND action="upload"
| table user, IP, _time

Detect attempts to use unauthorized web proxies.
index=SecnNet source="web" action=*
| search proxy!="*approved_proxy*"
| table user, proxy, _time

Identify machines with unusually high numbers of Windows login failures.
index=SecnNet action=failure source="system" earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to disable or modify antivirus software.
index=SecnNet source="system" action=*
| search antivirus="*modify*" OR antivirus="*disable*"
| table user, antivirus, _time

Get a list of all successful VPN logins from unusual IP addresses.
index=SecnNet source="vpn" action=login earliest=-24h
| search NOT src_ip="*allowed_IP*"
| table user, src_ip, _time

Detect attempts to use unauthorized chat applications.
index=SecnNet source="chat" action=*
| search app!="*approved_chat*"
| table user, app, _time

Identify machines with unusually high numbers of file modifications.
index=SecnNet source="file" action=modify earliest=-24h
| stats count by host
| where count > 1000
| table host, count, _time

Search for attempts to escalate privileges through DLL hijacking.
index=SecnNet source="system" action=*
| search description="*DLL hijacking*"
| table user, description, _time

Identify machines with unusually high numbers of process starts.
index=SecnNet source="system" action=start earliest=-24h
| stats count by host
| where count > 5000
| table host, count, _time

Search for attempts to use unauthorized virtualization software.
index=SecnNet source="virtualization" action=*
| search software!="*approved_software*"
| table user, software, _time

Get a list of all successful logins with unusual locations.
index=SecnNet action=login earliest=-24h
| iplocation src_ip
| stats count by user, Country
| where Country!="United States" AND count > 5
| table user, Country, _time

Detect attempts to use unauthorized email clients.
index=SecnNet source="email" action=*
| search client!="*approved_client*"
| table user, client, _time

Identify machines with unusually high numbers of network traffic to suspicious countries.
index=network source="network.log" earliest=-24h
| stats sum(bytes) as bytes by host, dest_country
| where dest_country IN ("North Korea", "Iran", "Russia") AND bytes > 100000000
| table host, dest_country, bytes, _time

Search for attempts to use unauthorized file compression software.
index=SecnNet source="file" action=*
| search compression!="*approved_compression*"
| table user, compression, _time

Get a list of all successful logins with unusual durations.
index=SecnNet action=login earliest=-24h
| eval duration = _time - _indextime
| search duration > 3600
| table user, IP, duration, _time

Detect attempts to use unauthorized remote desktop software.
index=SecnNet source="remote_desktop" action=*
| search software!="*approved_software*"
| table user, software, _time

Identify machines with unusually high numbers of file deletions.
index=SecnNet source="file" action=delete earliest=-24h
| stats count by host
| where count > 500
| table host, count, _time

Search for attempts to escalate privileges through DLL search order hijacking.
index=SecnNet source="system" action=*
| search description="*DLL search order hijacking*"
| table user, description, _time

Identify machines with unusually high numbers of failed logins to cloud services.
index=SecnNet source="cloud" action=failure earliest=-24h
| stats count by host
| where count > 1000
| table host, count, _time

Search for attempts to use unauthorized remote access tools.
index=SecnNet source="remote_access" action=*
| search tool!="*approved_tool*"
| table user, tool, _time

Get a list of all successful logins with unusual device types.
index=SecnNet action=login earliest=-24h
| search NOT device_type="*laptop*" AND NOT device_type="*desktop*"
| table user, device_type, _time

Detect attempts to use unauthorized software installation tools.
index=SecnNet source="system" action=*
| search software_installation!="*approved_tool*"
| table user, software_installation, _time

Identify machines with unusually high numbers of successful DNS queries to suspicious domains.
index=dns source="dns.log" earliest=-24h
| stats count by host, query
| where query IN ("malware-domain.com", "phishing-domain.com", "botnet-domain.com") AND count > 100
| table host, query, count, _time

Search for attempts to access unauthorized databases.
index=SecnNet source="database" action=*
| search database!="*approved_database*"
| table user, database, _time

Get a list of all successful logins with unusual login types.
index=SecnNet action=login earliest=-24h
| search NOT login_type="*password*" AND NOT login_type="*token*"
| table user, login_type, _time

Detect attempts to use unauthorized encryption software.
index=SecnNet source="file" action=*
| search encryption!="*approved_encryption*"
| table user, encryption, _time

Identify machines with unusually high numbers of file access failures.
index=SecnNet source="file" action=access_failure earliest=-24h
| stats count by host
| where count > 1000
| table host, count, _time

Search for attempts to escalate privileges through process injection.
index=SecnNet source="system" action=*
| search description="*process injection*"
| table user, description, _time

Identify machines with unusually high numbers of successful logins to cloud services.
index=SecnNet source="cloud" action=success earliest=-24h
| stats count by host
| where count > 1000
| table host, count, _time

Search for attempts to use unauthorized USB devices.
index=SecnNet source="usb" action=*
| search device!="*approved_device*"
| table user, device, _time

Get a list of all successful logins with unusual protocols.
index=SecnNet action=login earliest=-24h
| search NOT protocol="*http*" AND NOT protocol="*ssh*" AND NOT protocol="*ftp*"
| table user, protocol, _time

Detect attempts to use unauthorized screen capture software.
index=SecnNet source="system" action=*
| search screen_capture!="*approved_software*"
| table user, screen_capture, _time

Identify machines with unusually high numbers of outgoing network connections.
index=network source="network.log" earliest=-24h
| stats count by host
| where count > 10000
| table host, count, _time

Search for attempts to access unauthorized cloud storage buckets.
index=SecnNet source="cloud" action=*
| search bucket!="*approved_bucket*"
| table user, bucket, _time

Get a list of all successful logins with unusual geographic locations.
index=SecnNet action=login earliest=-24h
| iplocation src_ip
| stats count by user, City
| where City!="New York" AND City!="San Francisco" AND count > 5
| table user, City, _time

Detect attempts to use unauthorized password cracking software.
index=SecnNet source="system" action=*
| search password_cracker!="*approved_software*"
| table user, password_cracker, _time

Identify machines with unusually high numbers of file copies to external devices.
index=SecnNet source="file" action=copy earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to escalate privileges through registry hijacking.
index=SecnNet source="system" action=*
| search description="*registry hijacking*"
| table user, description, _time

Identify machines with unusually high numbers of failed logins to cloud services from a single IP address.
index=SecnNet source="cloud" action=failure earliest=-24h
| stats count by host, src_ip
| where count > 50
| table host, src_ip, count, _time

Search for attempts to use unauthorized Bluetooth devices.
index=SecnNet source="bluetooth" action=*
| search device!="*approved_device*"
| table user, device, _time

Get a list of all successful logins with unusual IP geolocations.
index=SecnNet action=login earliest=-24h
| iplocation src_ip
| stats count by user, City
| where City!="Los Angeles" AND City!="Seattle" AND count > 5
| table user, City, _time

Detect attempts to use unauthorized keylogging software.
index=SecnNet source="system" action=*
| search keylogger!="*approved_software*"
| table user, keylogger, _time

Identify machines with unusually high numbers of DNS requests to malicious domains.
index=dns source="dns.log" earliest=-24h
| stats count by host, query
| where query IN ("malware-domain.com", "phishing-domain.com", "botnet-domain.com") AND count > 1000
| table host, query, count, _time

Search for attempts to access unauthorized network shares.
index=SecnNet source="network" action=*
| search share!="*approved_share*"
| table user, share, _time

Get a list of all successful logins with unusual web browser types.
index=SecnNet action=login earliest=-24h
| search NOT browser_type="*Chrome*" AND NOT browser_type="*Firefox*" AND NOT browser_type="*Safari*"
| table user, browser_type, _time

Detect attempts to use unauthorized data encryption tools.
index=SecnNet source="file" action=*
| search data_encryption!="*approved_tool*"
| table user, data_encryption, _time

Identify machines with unusually high numbers of successful logins from a single IP address.
index=SecnNet action=success earliest=-24h
| stats count by host, src_ip
| where count > 50
| table host, src_ip, count, _time

Search for attempts to escalate privileges through DLL side-loading.
index=SecnNet source="system" action=*
| search description="*DLL side-loading*"
| table user, description, _time

Identify machines with unusually high numbers of failed logins to cloud services from a single user account.
index=SecnNet source="cloud" action=failure earliest=-24h
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to use unauthorized VPN software.
index=SecnNet source="network" action=*
| search vpn!="*approved_vpn*"
| table user, vpn, _time

Get a list of all successful logins with unusual device names.
index=SecnNet action=login earliest=-24h
| search NOT device_name="*PC*" AND NOT device_name="*Mac*"
| table user, device_name, _time

Detect attempts to use unauthorized remote control software.
index=SecnNet source="remote_access" action=*
| search remote_control!="*approved_software*"
| table user, remote_control, _time

Identify machines with unusually high numbers of inbound network connections.
index=network source="network.log" earliest=-24h
| stats count by dest_ip
| where count > 5000
| table dest_ip, count, _time

Search for attempts to access unauthorized cloud services.
index=SecnNet source="cloud" action=*
| search service!="*approved_service*"
| table user, service, _time

Get a list of all successful logins with unusual operating system versions.
index=SecnNet action=login earliest=-24h
| search NOT os_version="*Windows 10*" AND NOT os_version="*macOS Big Sur*"
| table user, os_version, _time

Detect attempts to use unauthorized software update tools.
index=SecnNet source="system" action=*
| search software_update!="*approved_tool*"
| table user, software_update, _time

Identify machines with unusually high numbers of file deletions.
index=SecnNet source="file" action=delete earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to escalate privileges through DLL hijacking.
index=SecnNet source="system" action=*
| search description="*DLL hijacking*"
| table user, description, _time

Identify machines with unusually high numbers of successful logins from a single user account.
index=SecnNet action=success earliest=-24h
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to use unauthorized network sniffing tools.
index=SecnNet source="network" action=*
| search sniffer!="*approved_tool*"
| table user, sniffer, _time

Get a list of all successful logins with unusual email clients.
index=SecnNet action=login earliest=-24h
| search NOT email_client="*Outlook*" AND NOT email_client="*Gmail*"
| table user, email_client, _time

Detect attempts to use unauthorized remote access software.
index=SecnNet source="remote_access" action=*
| search remote_access!="*approved_software*"
| table user, remote_access, _time

Identify machines with unusually high numbers of outgoing network connections to foreign countries.
index=network source="network.log" earliest=-24h
| iplocation dest_ip
| stats count by host, Country
| where Country!="United States" AND count > 10000
| table host, Country, count, _time

Search for attempts to access unauthorized database servers.
index=SecnNet source="database" action=*
| search server!="*approved_server*"
| table user, server, _time

Get a list of all successful logins with unusual email activity.
index=SecnNet action=login earliest=-24h
| search NOT email_subject="*Welcome*" AND NOT email_subject="*Password Reset*"
| table user, email_subject, _time

Detect attempts to use unauthorized disk encryption tools.
index=SecnNet source="file" action=*
| search disk_encryption!="*approved_tool*"
| table user, disk_encryption, _time

Identify machines with unusually high numbers of file modifications.
index=SecnNet source="file" action=modify earliest=-24h
| stats count by host
| where count > 500
| table host, count, _time

Search for attempts to escalate privileges through directory traversal.
index=SecnNet source="system" action=*
| search description="*directory traversal*"
| table user, description, _time

Identify machines with unusually high numbers of successful logins to cloud services from a single user account.
index=SecnNet source="cloud" action=success earliest=-24h
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to use unauthorized proxy servers.
index=SecnNet source="network" action=*
| search proxy_server!="*approved_server*"
| table user, proxy_server, _time

Get a list of all successful logins with unusual email attachments.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment="*Resume.pdf*" AND NOT email_attachment="*Invoice.docx*"
| table user, email_attachment, _time

Detect attempts to use unauthorized virtualization software.
index=SecnNet source="system" action=*
| search virtualization!="*approved_software*"
| table user, virtualization, _time

Identify machines with unusually high numbers of incoming network connections from a single IP address.
index=network source="network.log" earliest=-24h
| stats count by src_ip
| where count > 5000
| table src_ip, count, _time

Search for attempts to access unauthorized cloud storage accounts.
index=SecnNet source="cloud" action=*
| search storage_account!="*approved_account*"
| table user, storage_account, _time

Get a list of all successful logins with unusual email sender addresses.
index=SecnNet action=login earliest=-24h
| search NOT email_sender="*hr@company.com*" AND NOT email_sender="*it@company.com*"
| table user, email_sender, _time

Detect attempts to use unauthorized disk wiping tools.
index=SecnNet source="file" action=*
| search disk_wiping!="*approved_tool*"
| table user, disk_wiping, _time

Identify machines with unusually high numbers of file renames.
index=SecnNet source="file" action=rename earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to escalate privileges through unquoted service paths.
index=SecnNet source="system" action=*
| search description="*unquoted service path*"
| table user, description, _time

Identify machines with unusually high numbers of failed logins to network resources from a single user account.
index=SecnNet source="network" action=failure earliest=-24h
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to use unauthorized password cracking tools.
index=SecnNet source="password_cracking" action=*
| search password_cracker!="*approved_tool*"
| table user, password_cracker, _time

Get a list of all successful logins with unusual email activity based on timestamps.
index=SecnNet action=login earliest=-24h
| search NOT email_subject="*Welcome*" AND NOT email_subject="*Password Reset*"
| bin _time span=1h
| stats count by user, email_subject, span
| where count > 10
| table user, email_subject, span, count

Detect attempts to use unauthorized data exfiltration tools.
index=SecnNet source="data_exfiltration" action=*
| search data_exfiltration!="*approved_tool*"
| table user, data_exfiltration, _time

Identify machines with unusually high numbers of outbound network connections to known malicious IP addresses.
index=network source="network.log" earliest=-24h
| iplocation dest_ip
| where isnotnull(City) AND isnotnull(Country) AND Country!="United States"
| lookup mal_ip_lookup ip as dest_ip OUTPUT threat_score, threat_category
| stats count by host, dest_ip, threat_category, threat_score
| where threat_score > 10
| table host, dest_ip, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud storage buckets.
index=SecnNet source="cloud" action=*
| search storage_bucket!="*approved_bucket*"
| table user, storage_bucket, _time

Get a list of all successful logins with unusual email recipient addresses.
index=SecnNet action=login earliest=-24h
| search NOT email_recipient="*hr@company.com*" AND NOT email_recipient="*it@company.com*"
| table user, email_recipient, _time

Detect attempts to use unauthorized data encryption tools.
index=SecnNet source="file" action=*
| search data_encryption!="*approved_tool*"
| table user, data_encryption, _time

Identify machines with unusually high numbers of file copies.
index=SecnNet source="file" action=copy earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to escalate privileges through DLL search order hijacking.
index=SecnNet source="system" action=*
| search description="*DLL search order hijacking*"
| table user, description, _time

Identify machines with unusually high numbers of failed logins to cloud services from a single user account.
index=SecnNet source="cloud" action=failure earliest=-24h
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to use unauthorized VPN software.
index=SecnNet source="network" action=*
| search vpn!="*approved_software*"
| table user, vpn, _time

Get a list of all successful logins with unusual email content.
index=SecnNet action=login earliest=-24h
| search NOT email_body="*Welcome to our company!*" AND NOT email_body="*Please reset your password*"
| table user, email_body, _time

Detect attempts to use unauthorized browser extensions.
index=SecnNet source="browser" action=*
| search extension!="*approved_extension*"
| table user, extension, _time

Identify machines with unusually high numbers of outgoing network connections to known malicious domains.
index=network source="network.log" earliest=-24h
| rex "(?<domain>http| https)://(?<domainname>.*?)/"
| search NOT domainname="*company.com*"
| lookup mal_domain_lookup domainname as domainname OUTPUT threat_score, threat_category
| stats count by host, domainname, threat_category, threat_score
| where threat_score > 10
| table host, domainname, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services.
index=SecnNet source="cloud" action=*
| search cloud_service!="*approved_service*"
| table user, cloud_service, _time

Get a list of all successful logins with unusual email header information.
index=SecnNet action=login earliest=-24h
| search NOT email_header="*Received: from mail.company.com*" AND NOT email_header="*X-Mailer: Microsoft Outlook*"
| table user, email_header, _time

Detect attempts to use unauthorized data compression tools.
index=SecnNet source="file" action=*
| search data_compression!="*approved_tool*"
| table user, data_compression, _time

Identify machines with unusually high numbers of file deletions.
index=SecnNet source="file" action=delete earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to escalate privileges through named pipe impersonation.
index=SecnNet source="system" action=*
| search description="*named pipe impersonation*"
| table user, description, _time

Identify machines with unusually high numbers of failed logins to network resources from a single IP address.
index=SecnNet source="network" action=failure earliest=-24h
| stats count by host, src_ip
| where count > 50
| table host, src_ip, count, _time

Search for attempts to use unauthorized network scanning tools.
index=SecnNet source="network" action=*
| search network_scanner!="*approved_tool*"
| table user, network_scanner, _time

Get a list of all successful logins with unusual email addresses in the CC field.
index=SecnNet action=login earliest=-24h
| search NOT email_cc="*hr@company.com*" AND NOT email_cc="*it@company.com*"
| table user, email_cc, _time

Detect attempts to use unauthorized system administration tools.
index=SecnNet source="system" action=*
| search system_administration_tool!="*approved_tool*"
| table user, system_administration_tool, _time

Identify machines with unusually high numbers of outgoing network connections to unknown IP addresses.
index=network source="network.log" earliest=-24h
| iplocation dest_ip
| where isnull(City) AND isnull(Country)
| stats count by host, dest_ip
| where count > 100
| table host, dest_ip, count, _time

Search for attempts to access unauthorized cloud storage files.
index=SecnNet source="cloud" action=*
| search storage_file!="*approved_file*"
| table user, storage_file, _time

Get a list of all successful logins with unusual email addresses in the BCC field.
index=SecnNet action=login earliest=-24h
| search NOT email_bcc="*hr@company.com*" AND NOT email_bcc="*it@company.com*"
| table user, email_bcc, _time

Detect attempts to use unauthorized system backup tools.
index=SecnNet source="system" action=*
| search system_backup_tool!="*approved_tool*"
| table user, system_backup_tool, _time

Identify machines with unusually high numbers of file reads.
index=SecnNet source="file" action=read earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to escalate privileges through weak file permissions.
index=SecnNet source="file" action=*
| search file_permissions="*weak_permissions*"
| table user, file_permissions, _time

Identify machines with unusually high numbers of failed logins to cloud services from a single IP address.
index=SecnNet source="cloud" action=failure earliest=-24h
| stats count by host, src_ip
| where count > 50
| table host, src_ip, count, _time

Search for attempts to use unauthorized system monitoring tools.
index=SecnNet source="system" action=*
| search system_monitoring_tool!="*approved_tool*"
| table user, system_monitoring_tool, _time

Get a list of all successful logins with unusual email addresses in the reply-to field.
index=SecnNet action=login earliest=-24h
| search NOT email_reply_to="*hr@company.com*" AND NOT email_reply_to="*it@company.com*"
| table user, email_reply_to, _time

Detect attempts to use unauthorized registry editing tools.
index=SecnNet source="system" action=*
| search registry_editor!="*approved_tool*"
| table user, registry_editor, _time

Identify machines with unusually high numbers of outbound network connections to unknown domains.
index=network source="network.log" earliest=-24h
| rex "(?<domain>http| https)://(?<domainname>.*?)/"
| search NOT domainname="*company.com*"
| lookup mal_domain_lookup domainname as domainname OUTPUT threat_score, threat_category
| stats count by host, domainname, threat_category, threat_score
| where threat_score < 1
| table host, domainname, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved devices.
index=SecnNet source="cloud" action=*
| search device!="*approved_device*"
| table user, device, _time

Get a list of all successful logins with unusual email addresses in the from field.
index=SecnNet action=login earliest=-24h
| search NOT email_from="*hr@company.com*" AND NOT email_from="*it@company.com*"
| table user, email_from, _time

Detect attempts to use unauthorized software installation tools.
index=SecnNet source="system" action=*
| search software_installation_tool!="*approved_tool*"
| table user, software_installation_tool, _time

Identify machines with unusually high numbers of file modifications.
index=SecnNet source="file" action=modify earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to escalate privileges through weak service permissions.
index=SecnNet source="system" action=*
| search service_permissions="*weak_permissions*"
| table user, service_permissions, _time

Identify machines with unusually high numbers of failed logins to network resources from a single user account.
index=SecnNet source="network" action=failure earliest=-24h
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to use unauthorized USB devices.
index=SecnNet source="system" action=*
| search usb_device!="*approved_device*"
| table user, usb_device, _time

Get a list of all successful logins with unusual email attachments.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment="*resume.pdf*" AND NOT email_attachment="*project_report.docx*"
| table user, email_attachment, _time

Detect attempts to use unauthorized remote desktop software.
index=SecnNet source="system" action=*
| search remote_desktop!="*approved_software*"
| table user, remote_desktop, _time

Identify machines with unusually high numbers of outbound network connections to known malicious IP addresses.
index=network source="network.log" earliest=-24h
| iplocation dest_ip
| lookup mal_ip_lookup dest_ip as dest_ip OUTPUT threat_score, threat_category
| stats count by host, dest_ip, threat_category, threat_score
| where threat_score > 10
| table host, dest_ip, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved browsers.
index=SecnNet source="cloud" action=*
| search browser!="*approved_browser*"
| table user, browser, _time

Get a list of all successful logins with unusual email subjects.
index=SecnNet action=login earliest=-24h
| search NOT email_subject="*Login successful*" AND NOT email_subject="*Password reset*"
| table user, email_subject, _time

Detect attempts to use unauthorized virtualization software.
index=SecnNet source="system" action=*
| search virtualization!="*approved_software*"
| table user, virtualization, _time

Identify machines with unusually high numbers of failed logins.
index=SecnNet action=failure earliest=-24h
| stats count by host
| where count > 100
| table host, count, _time

Search for attempts to escalate privileges through weak user account permissions.
index=SecnNet source="system" action=*
| search user_account_permissions="*weak_permissions*"
| table user, user_account_permissions, _time

Identify machines with unusually high numbers of failed logins to cloud services from a single user account.
index=SecnNet source="cloud" action=failure earliest=-24h
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to use unauthorized system configuration tools.
index=SecnNet source="system" action=*
| search system_configuration_tool!="*approved_tool*"
| table user, system_configuration_tool, _time

Get a list of all successful logins with unusual email bodies.
index=SecnNet action=login earliest=-24h
| search NOT email_body="*Please find attached*" AND NOT email_body="*Dear Sir/Madam*"
| table user, email_body, _time

Detect attempts to use unauthorized data recovery tools.
index=SecnNet source="system" action=*
| search data_recovery_tool!="*approved_tool*"
| table user, data_recovery_tool, _time

Identify machines with unusually high numbers of outbound network connections to known malicious domains.
index=network source="network.log" earliest=-24h
| rex "(?<domain>http| https)://(?<domainname>.*?)/"
| lookup mal_domain_lookup domainname as domainname OUTPUT threat_score, threat_category
| stats count by host, domainname, threat_category, threat_score
| where threat_score > 10
| table host, domainname, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved mobile devices.
index=SecnNet source="cloud" action=*
| search device_type!="*approved_mobile_device*"
| table user, device_type, _time

Get a list of all successful logins with unusual email signatures.
index=SecnNet action=login earliest=-24h
| search NOT email_signature="*Best regards*" AND NOT email_signature="*Sincerely*"
| table user, email_signature, _time

Detect attempts to use unauthorized virtual private network (VPN) software.
index=SecnNet source="system" action=*
| search vpn_software!="*approved_software*"
| table user, vpn_software, _time

Identify machines with unusually high numbers of failed logins to web applications from a single IP address.
index=SecnNet source="web" action=failure earliest=-24h
| stats count by host, src_ip
| where count > 50
| table host, src_ip, count, _time

Search for attempts to escalate privileges through weak group policy permissions.
index=SecnNet source="system" action=*
| search group_policy_permissions="*weak_permissions*"
| table user, group_policy_permissions, _time

Identify machines with unusually high numbers of failed logins to network resources from a single domain account.
index=SecnNet source="network" action=failure earliest=-24h
| stats count by host, domain_account
| where count > 50
| table host, domain_account, count, _time

Search for attempts to use unauthorized system monitoring tools.
index=SecnNet source="system" action=*
| search system_monitoring_tool!="*approved_tool*"
| table user, system_monitoring_tool, _time

Get a list of all successful logins with unusual email senders and subjects.
index=SecnNet action=login earliest=-24h
| search NOT email_sender="*admin@company.com*" AND NOT email_sender="*support@company.com*" AND NOT email_subject="*Login successful*" AND NOT email_subject="*Password reset*"
| table user, email_sender, email_subject, _time

Detect attempts to use unauthorized disk encryption software.
index=SecnNet source="system" action=*
| search disk_encryption_software!="*approved_software*"
| table user, disk_encryption_software, _time

Identify machines with unusually high numbers of outbound network connections to unknown domains.
index=network source="network.log" earliest=-24h
| rex "(?<domain>http|https)://(?<domainname>.*?)/"
| lookup mal_domain_lookup domainname as domainname OUTPUT threat_score, threat_category
| stats count by host, domainname, threat_category, threat_score
| where threat_score < 1
| table host, domainname, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved operating system versions.
index=SecnNet source="cloud" action=*
| search os_version!="*approved_os_version*"
| table user, os_version, _time

Get a list of all successful logins with unusual email attachments and recipients.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment="*resume.pdf*" AND NOT email_attachment="*project_report.docx*" AND NOT email_recipient="*admin@company.com*" AND NOT email_recipient="*support@company.com*"
| table user, email_attachment, email_recipient, _time

Detect attempts to use unauthorized remote access software.
index=SecnNet source="system" action=*
| search remote_access_software!="*approved_software*"
| table user, remote_access_software, _time

Identify machines with unusually high numbers of failed logins to web applications from a single domain account.
index=SecnNet source="web" action=failure earliest=-24h
| stats count by host, domain_account
| where count > 50
| table host, domain_account, count, _time

Search for attempts to escalate privileges through weak registry permissions.
index=SecnNet source="system" action=*
| search registry_permissions="*weak_permissions*"
| table user, registry_permissions, _time

Identify machines with unusually high numbers of failed logins to network resources from a single domain group.
index=SecnNet source="network" action=failure earliest=-24h
| stats count by host, domain_group
| where count > 50
| table host, domain_group, count, _time

Search for attempts to use unauthorized database tools.
index=SecnNet source="database" action=*
| search database_tool!="*approved_tool*"
| table user, database_tool, _time

Get a list of all successful logins with unusual email attachment types.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment="*.pdf" AND NOT email_attachment="*.docx"
| table user, email_attachment, _time

Detect attempts to use unauthorized disk partitioning software.
index=SecnNet source="system" action=*
| search disk_partitioning_software!="*approved_software*"
| table user, disk_partitioning_software, _time

Identify machines with unusually high numbers of outbound network connections to known phishing domains.
index=network source="network.log" earliest=-24h
| rex "(?<domain>http|https)://(?<domainname>.*?)/"
| lookup phishing_domain_lookup domainname as domainname OUTPUT threat_score, threat_category
| stats count by host, domainname, threat_category, threat_score
| where threat_score > 10
| table host, domainname, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved web browsers.
index=SecnNet source="cloud" action=*
| search web_browser!="*approved_browser*"
| table user, web_browser, _time

Get a list of all successful logins with unusual email attachment sizes.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment_size="*1MB*" AND NOT email_attachment_size="*2MB*"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized remote execution tools.
index=SecnNet source="system" action=*
| search remote_execution_tool!="*approved_tool*"
| table user, remote_execution_tool, _time

Identify machines with unusually high numbers of failed logins to web applications from a single domain group.
index=SecnNet source="web" action=failure earliest=-24h
| stats count by host, domain_group
| where count > 50
| table host, domain_group, count, _time

Search for attempts to escalate privileges through weak service permissions.
index=SecnNet source="system" action=*
| search service_permissions="*weak_permissions*"
| table user, service_permissions, _time

Identify machines with unusually high numbers of failed logins to network resources from a single user account with non-standard characters in the username.
index=SecnNet source="network" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to use unauthorized email clients.
index=SecnNet source="email" action=*
| search email_client!="*approved_client*"
| table user, email_client, _time

Get a list of all successful logins with unusual email attachment extensions.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment="*.pdf" AND NOT email_attachment="*.docx" AND NOT email_attachment="*.xls"
| table user, email_attachment, _time

Detect attempts to use unauthorized VPN software.
index=SecnNet source="network" action=*
| search vpn_software!="*approved_software*"
| table user, vpn_software, _time

Identify machines with unusually high numbers of outbound network connections to known command-and-control servers.
index=network source="network.log" earliest=-24h
| lookup cnc_ip_lookup dest_ip as dest_ip OUTPUT threat_score, threat_category
| stats count by host, dest_ip, threat_category, threat_score
| where threat_score > 10
| table host, dest_ip, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved VPN connections.
index=SecnNet source="cloud" action=*
| search vpn_connection!="*approved_connection*"
| table user, vpn_connection, _time

Get a list of all successful logins with unusual email body content.
index=SecnNet action=login earliest=-24h
| search NOT email_body="*Welcome to our platform*" AND NOT email_body="*Please reset your password*"
| table user, email_body, _time

Detect attempts to use unauthorized remote access tools.
index=SecnNet source="system" action=*
| search remote_access_tool!="*approved_tool*"
| table user, remote_access_tool, _time

Identify machines with unusually high numbers of failed logins to web applications from a single user account with non-standard characters in the username.
index=SecnNet source="web" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| stats count by host, user
| where count > 50
| table host, user, count, _time

Search for attempts to escalate privileges through weak user account permissions.
index=SecnNet source="system" action=*
| search user_account_permissions="*weak_permissions*"
| table user, user_account_permissions, _time

Identify machines with unusually high numbers of failed logins to network resources from a single user account with unusual IP addresses.
index=SecnNet source="network" action=failure earliest=-24h
| rex field=src_ip "(?<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"
| stats count by host, src_ip
| where count > 50
| table host, src_ip, count, _time

Search for attempts to use unauthorized software development tools.
index=SecnNet source="development" action=*
| search software_development_tool!="*approved_tool*"
| table user, software_development_tool, _time

Get a list of all successful logins with unusual email body lengths.
index=SecnNet action=login earliest=-24h
| search NOT len(email_body)="*1000" AND NOT len(email_body)="*2000" AND NOT len(email_body)="*3000"
| table user, len(email_body), _time

Detect attempts to use unauthorized browser extensions.
index=SecnNet source="browser" action=*
| search browser_extension!="*approved_extension*"
| table user, browser_extension, _time

Identify machines with unusually high numbers of outbound network connections to known malware distribution sites.
index=network source="network.log" earliest=-24h
| lookup malware_distribution_site_lookup dest_ip as dest_ip OUTPUT threat_score, threat_category
| stats count by host, dest_ip, threat_category, threat_score
| where threat_score > 10
| table host, dest_ip, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved mobile devices.
index=SecnNet source="cloud" action=*
| search mobile_device!="*approved_device*"
| table user, mobile_device, _time

Get a list of all successful logins with unusual email body content types.
index=SecnNet action=login earliest=-24h
| search NOT email_body_type="*text*" AND NOT email_body_type="*html*"
| table user, email_body_type, _time

Detect attempts to use unauthorized privilege escalation tools.
index=SecnNet source="system" action=*
| search privilege_escalation_tool!="*approved_tool*"
| table user, privilege_escalation_tool, _time

Identify machines with unusually high numbers of failed logins to web applications from a single user account with unusual IP addresses.
index=SecnNet source="web" action=failure earliest=-24h
| rex field=src_ip "(?<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"
| stats count by host, src_ip
| where count > 50
| table host, src_ip, count, _time

Search for attempts to escalate privileges through weak file system permissions.
index=SecnNet source="system" action=*
| search file_system_permissions="*weak_permissions*"
| table user, file_system_permissions, _time

Identify machines with unusually high numbers of failed logins to network resources from a single user account with non-standard timezones.
index=SecnNet source="network" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| rex field=_time "(?<timezone>[+-]\d{2}:?\d{2})"
| stats count by host, user, timezone
| where count > 50
| table host, user, timezone, count, _time

Search for attempts to use unauthorized FTP clients.
index=SecnNet source="network" action=* ftp_client!="*approved_client*"
| table user, ftp_client, _time

Get a list of all successful logins with unusual email attachment sizes.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment_size="*100KB" AND NOT email_attachment_size="*500KB" AND NOT email_attachment_size="*1MB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized SSH clients.
index=SecnNet source="network" action=* ssh_client!="*approved_client*"
| table user, ssh_client, _time

Identify machines with unusually high numbers of outbound network connections to known phishing sites.
index=network source="network.log" earliest=-24h
| lookup phishing_site_lookup dest_ip as dest_ip OUTPUT threat_score, threat_category
| stats count by host, dest_ip, threat_category, threat_score
| where threat_score > 10
| table host, dest_ip, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved browsers.
index=SecnNet source="cloud" action=*
| search browser!="*approved_browser*"
| table user, browser, _time

Get a list of all successful logins with unusual email attachment file types.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment_type="*doc*" AND NOT email_attachment_type="*pdf*" AND NOT email_attachment_type="*xls*"
| table user, email_attachment_type, _time

Detect attempts to use unauthorized privilege escalation techniques through system calls.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*"
| table user, privilege_escalation_technique, _time

Identify machines with unusually high numbers of failed logins to web applications from a single user account with non-standard timezones.
index=SecnNet source="web" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| rex field=_time "(?<timezone>[+-]\d{2}:?\d{2})"
| stats count by host, user, timezone
| where count > 50
| table host, user, timezone, count, _time

Search for attempts to escalate privileges through weak database permissions.
index=SecnNet source="database" action=*
| search database_permissions="*weak_permissions*"
| table user, database_permissions, _time

Identify machines with unusually high numbers of failed logins to network resources from a single user account with non-standard keyboard layouts.
index=SecnNet source="network" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| rex field=src_ip "(?<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"
| rex field=_raw "(?<keyboard_layout>azerty|colemak|dvorak|qwerty)"
| stats count by host, user, src_ip, keyboard_layout
| where count > 50
| table host, user, src_ip, keyboard_layout, count, _time

Search for attempts to use unauthorized network mapping tools.
index=SecnNet source="network" action=*
| search network_mapping_tool!="*approved_tool*"
| table user, network_mapping_tool, _time

Get a list of all successful logins with unusual email attachment file names.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment_name="*resume*" AND NOT email_attachment_name="*invoice*" AND NOT email_attachment_name="*contract*"
| table user, email_attachment_name, _time

Detect attempts to use unauthorized VPN clients.
index=SecnNet source="network" action=* vpn_client!="*approved_client*"
| table user, vpn_client, _time

Identify machines with unusually high numbers of outbound network connections to known command and control servers.
index=network source="network.log" earliest=-24h
| lookup command_and_control_server_lookup dest_ip as dest_ip OUTPUT threat_score, threat_category
| stats count by host, dest_ip, threat_category, threat_score
| where threat_score > 10
| table host, dest_ip, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved operating systems.
index=SecnNet source="cloud" action=*
| search operating_system!="*approved_OS*"
| table user, operating_system, _time

Get a list of all successful logins with unusual email attachment file extensions.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment_extension="*docx*" AND NOT email_attachment_extension="*pdf*" AND NOT email_attachment_extension="*xlsx*"
| table user, email_attachment_extension, _time

Detect attempts to use unauthorized privilege escalation techniques through service accounts.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*" AND user="*service_account*"
| table user, privilege_escalation_technique, _time

Identify machines with unusually high numbers of failed logins to web applications from a single user account with non-standard keyboard layouts.
index=SecnNet source="web" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| rex field=src_ip "(?<src_ip>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"
| rex field=_raw "(?<keyboard_layout>azerty|colemak|dvorak|qwerty)"
| stats count by host, user, src_ip, keyboard_layout
| where count > 50
| table host, user, src_ip, keyboard_layout, count, _time

Search for attempts to use unauthorized network scanning tools.
index=SecnNet source="network" action=*
| search network_scanning_tool!="*approved_tool*"
| table user, network_scanning_tool, _time

Get a list of all successful logins with unusual email attachment MIME types.
index=SecnNet action=login earliest=-24h
| search NOT email_attachment_mime_type="*application/pdf*" AND NOT email_attachment_mime_type="*application/msword*" AND NOT email_attachment_mime_type="*application/vnd.ms-excel*"
| table user, email_attachment_mime_type, _time

Detect attempts to use unauthorized remote desktop software.
index=SecnNet source="network" action=* remote_desktop_software!="*approved_software*"
| table user, remote_desktop_software, _time

Identify machines with unusually high numbers of outbound network connections to known malicious IP addresses.
index=network source="network.log" earliest=-24h
| lookup malicious_ip_lookup dest_ip as dest_ip OUTPUT threat_score, threat_category
| stats count by host, dest_ip, threat_category, threat_score
| where threat_score > 10
| table host, dest_ip, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved mobile devices.
index=SecnNet source="cloud" action=*
| search mobile_device!="*approved_device*"
| table user, mobile_device, _time

Get a list of all successful logins with unusual email attachment sizes for financial reports.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*financial_report*" AND NOT email_attachment_size="*500KB" AND NOT email_attachment_size="*1MB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized privilege escalation techniques through file system manipulation.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*" AND user="*file_system_manipulation*"
| table user, privilege_escalation_technique, _time

Identify machines with unusually high numbers of failed logins to network resources from a single user account with non-standard browser versions.
index=SecnNet source="network" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| rex field=_raw "(?<browser_version>\d{1,2}\.\d{1,2})"
| stats count by host, user, browser_version
| where count > 50
| table host, user, browser_version, count, _time

Search for attempts to escalate privileges through unapproved scripts.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*" AND user="*scripting*"
| table user, privilege_escalation_technique, _time

Get a list of all successful logins with unusual email attachment file sizes for contracts.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*contract*" AND NOT email_attachment_size="*100KB" AND NOT email_attachment_size="*500KB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized file transfer tools.
index=SecnNet source="network" action=*
| search file_transfer_tool!="*approved_tool*"
| table user, file_transfer_tool, _time

Identify machines with unusually high numbers of outbound network connections to known malicious domains.
index=network source="network.log" earliest=-24h
| lookup malicious_domain_lookup dest_domain as dest OUTPUT threat_score, threat_category
| stats count by host, dest, threat_category, threat_score
| where threat_score > 10
| table host, dest, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved browsers.
index=SecnNet source="cloud" action=*
| search browser!="*approved_browser*"
| table user, browser, _time

Get a list of all successful logins with unusual email attachment file sizes for resumes.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*resume*" AND NOT email_attachment_size="*200KB" AND NOT email_attachment_size="*500KB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized remote access tools.
index=SecnNet source="network" action=* remote_access_tool!="*approved_tool*"
| table user, remote_access_tool, _time

Identify machines with unusually high numbers of failed logins to web applications from a single user account with non-standard browser types.
index=SecnNet source="web" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| rex field=_raw "(?<browser_type>chrome|firefox|safari|edge)"
| stats count by host, user, browser_type
| where count > 50
| table host, user, browser_type, count, _time

Search for attempts to use unauthorized privilege escalation techniques through suspicious processes.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*" AND user="*suspicious_processes*"
| table user, privilege_escalation_technique, _time

Get a list of all successful logins with unusual email attachment file sizes for invoices.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*invoice*" AND NOT email_attachment_size="*50KB" AND NOT email_attachment_size="*100KB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized network sniffing tools.
index=SecnNet source="network" action=*
| search network_sniffing_tool!="*approved_tool*"
| table user, network_sniffing_tool, _time

Identify machines with unusually high numbers of outbound network connections to known phishing domains.
index=network source="network.log" earliest=-24h
| lookup phishing_domain_lookup dest_domain as dest OUTPUT threat_score, threat_category
| stats count by host, dest, threat_category, threat_score
| where threat_score > 10
| table host, dest, threat_category, threat_score, _time

Search for attempts to access unauthorized cloud services through unapproved operating systems.
index=SecnNet source="cloud" action=*
| search os!="*approved_os*"
| table user, os, _time

Get a list of all successful logins with unusual email attachment file sizes for legal documents.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*legal_document*" AND NOT email_attachment_size="*300KB" AND NOT email_attachment_size="*500KB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized port scanning tools.
index=SecnNet source="network" action=*
| search port_scanning_tool!="*approved_tool*"
| table user, port_scanning_tool, _time

Identify machines with unusually high numbers of outbound network connections to known crypto mining domains.
index=network source="network.log" earliest=-24h
| lookup crypto_mining_domain_lookup dest_domain as dest OUTPUT threat_score, threat_category
| stats count by host, dest, threat_category, threat_score
| where threat_score > 10
| table host, dest, threat_category, threat_score, _time

Search for attempts to use unauthorized tools for privilege escalation through DLL hijacking.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*" AND user="*dll_hijacking*"
| table user, privilege_escalation_technique, _time

Get a list of all successful logins with unusual email attachment file sizes for resumes.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*resume*" AND NOT email_attachment_size="*200KB" AND NOT email_attachment_size="*500KB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized password cracking tools.
index=SecnNet source="system" action=*
| search password_cracking_tool!="*approved_tool*"
| table user, password_cracking_tool, _time

Identify machines with unusually high numbers of failed logins to network resources from a single user account with non-standard operating system versions.
index=SecnNet source="network" action=failure earliest=-24h
| rex field=user "(?<user>[a-zA-Z0-9]+)"
| rex field=_raw "(?<os_version>\d{1,2}\.\d{1,2})"
| stats count by host, user, os_version
| where count > 50
| table host, user, os_version, count, _time

Search for attempts to use unauthorized network eavesdropping tools.
index=SecnNet source="network" action=*
| search network_eavesdropping_tool!="*approved_tool*"
| table user, network_eavesdropping_tool, _time

Identify machines with unusually high numbers of outbound network connections to known spamming domains.
index=network source="network.log" earliest=-24h
| lookup spamming_domain_lookup dest_domain as dest OUTPUT threat_score, threat_category
| stats count by host, dest, threat_category, threat_score
| where threat_score > 10
| table host, dest, threat_category, threat_score, _time

Search for attempts to use unauthorized tools for privilege escalation through Registry hijacking.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*" AND user="*registry_hijacking*"
| table user, privilege_escalation_technique, _time

Get a list of all successful logins with unusual email attachment file sizes for financial documents.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*financial_document*" AND NOT email_attachment_size="*100KB" AND NOT email_attachment_size="*200KB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized network monitoring tools.
index=SecnNet source="network" action=*
| search network_monitoring_tool!="*approved_tool*"
| table user, network_monitoring_tool, _time

Identify machines with unusually high numbers of outbound network connections to known ransomware domains.
index=network source="network.log" earliest=-24h
| lookup ransomware_domain_lookup dest_domain as dest OUTPUT threat_score, threat_category
| stats count by host, dest, threat_category, threat_score
| where threat_score > 10
| table host, dest, threat_category, threat_score, _time

Search for attempts to use unauthorized tools for privilege escalation through system file manipulation.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*" AND user="*system_file_manipulation*"
| table user, privilege_escalation_technique, _time

Get a list of all successful logins with unusual email attachment file sizes for contracts.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*contract*" AND NOT email_attachment_size="*150KB" AND NOT email_attachment_size="*300KB"
| table user, email_attachment_size, _time

Detect attempts to use unauthorized network sniffing tools.
index=SecnNet source="network" action=*
| search network_sniffing_tool!="*approved_tool*"
| table user, network_sniffing_tool, _time

Identify machines with unusually high numbers of outbound network connections to known C2 servers.
index=network source="network.log" earliest=-24h
| lookup C2_domain_lookup dest_domain as dest OUTPUT threat_score, threat_category
| stats count by host, dest, threat_category, threat_score
| where threat_score > 10
| table host, dest, threat_category, threat_score, _time

Search for attempts to use unauthorized tools for privilege escalation through impersonation.
index=SecnNet source="system" action=*
| search privilege_escalation_technique!="*approved_technique*" AND user="*impersonation*"
| table user, privilege_escalation_technique, _time

Get a list of all successful logins with unusual email attachment file sizes for confidential documents.
index=SecnNet action=login earliest=-24h
| search email_attachment_name="*confidential*" AND NOT email_attachment_size="*250KB" AND NOT email_attachment_size="*500KB"
| table user, email_attachment_size, _time


